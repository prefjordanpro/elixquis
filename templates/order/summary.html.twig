    {% extends 'base.html.twig' %}

    {% block body %}
    <div class="container-md my-5">
    <h1 class="h3 mb-4">Récapitulatif de ma commande</h1>

    <div class="row g-4">
        <div class="col-lg-8">

        {# Adresse #}
        <div class="card shadow border-1 bg-body-secondary">
            <div class="card-body">
            <div class="d-flex align-items-center gap-2 mb-2">
                <i data-feather="map-pin"></i>
                <h2 class="h5 mb-0">Adresse de livraison</h2>
            </div>

            {% if address is defined and address %}
                <p class="mb-0">
                {{ address.firstname }} {{ address.lastname }}<br>
                {{ address.address }}<br>
                {{ address.postal }} {{ address.city }} — {{ address.country }}
                </p>
            {% else %}
                <p class="text-muted mb-0"><em>Aucune adresse reçue. Retournez à l’étape précédente.</em></p>
            {% endif %}
            </div>
        </div>

        {# Transporteur #}
        <div class="card shadow border-1 bg-body-secondary mt-3">
            <div class="card-body">
            <div class="d-flex align-items-center gap-2 mb-2">
                <i data-feather="truck"></i>
                <h2 class="h5 mb-0">Transporteur</h2>
            </div>

            {% if carrier is defined and carrier %}
                <p class="mb-1 fw-semibold">{{ carrier.name }}</p>
                <p class="text-muted small mb-2">{{ carrier.description }}</p>
                <p class="mb-0">
                <strong>Frais de livraison :</strong>
                {{ carrier.price|number_format(2, ',', ' ') }} €
                </p>
            {% else %}
                <p class="text-muted mb-0"><em>Aucun transporteur sélectionné.</em></p>
            {% endif %}
            </div>
        </div>

        </div>

        {# Résumé / Totaux #}
        <div class="col-lg-4">
        <div class="card shadow position-sticky" style="top: 2rem;">
            <div class="card-body">
            <h2 class="h6 mb-3">Résumé</h2>

            <div class="d-flex justify-content-between">
                <span>Total produit</span>
                <strong>
                {% if totalWt is defined %}
                    {{ totalWt|price }}
                {% else %}
                    —
                {% endif %}
                </strong>
            </div>

            <div class="d-flex justify-content-between mt-2">
                <span>Livraison</span>
                <strong>
                {% if carrier is defined and carrier %}
                    {{ carrier.price|number_format(2, ',', ' ') }} €
                {% else %}
                    —
                {% endif %}
                </strong>
            </div>

            <hr class="my-3">

            <div class="d-flex justify-content-between">
                <span>Total TTC</span>
                <strong>
                {% if grandTotal is defined %}
                    {{ grandTotal|price }}
                {% elseif totalWt is defined and carrier is defined and carrier %}
                    {{ (totalWt + carrier.price)|price }}
                {% elseif totalWt is defined %}
                    {{ totalWt|price }}
                {% else %}
                    —
                {% endif %}
                </strong>
            </div>

            <div class="d-grid mt-3">
                <a href="{{ path('app_order') }}" class="btn btn-outline-secondary">Modifier</a>
                {# TODO: remplace '#' par ta route de paiement quand elle sera prête (ex: app_payment_start) #}
                <a href="#" class="btn btn-success mt-2">Payer</a>
            </div>
            </div>
        </div>
        </div>
    </div>

    </div>
    {% endblock %}
